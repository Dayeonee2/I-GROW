{% load static %}

{% block header %}
<link rel="stylesheet" href="{% static 'css/header.css' %}">

<header>
  <div class="menu-1">
    <div role="button" href="" style="margin-right: 65px; display: flex; align-items: center;" onclick="location.href='/'">
        <img src="{%static 'image/아이그로우로고.png'%} " alt="아이그로우 로고" style="width:auto; height:80px; cursor: pointer;">
    </div>
    <button class="toggle-btn" onclick="toggleMenu()" style="top:27px;">☰</button>
    <nav role="navigation">
      <ul>
        <li class="opt"><a href="/aboutus/" aria-expanded="false" onclick="toggleSubmenu(event, this)">회사소개</a>
          <ul>
            <li class="opt2"><a href="/aboutus/">인사말</a></li>
            <li class="opt2"><a href="/aboutus/">사업실적</a></li>
            <li class="opt2"><a href="/aboutus/">조직구성</a></li>
            <li class="opt2"><a href="/aboutus/">인증 및 보유시설</a></li>
            <li class="opt2"><a href="/aboutus/">오시는길</a></li>
          </ul>
        </li>    
        <li class="opt"><a href="/core/" aria-expanded="false" onclick="toggleSubmenu(event, this)">핵심사업</a>
          <ul>
            <li class="opt2"><a href="/core/">대학 중장기</a></li>
            <li class="opt2"><a href="/core/">교육과정</a></li>
            <li class="opt2"><a href="/core/">조직개편</a></li>
            <li class="opt2"><a href="/core/">만족도조사</a></li>
          </ul>
        </li>
        <li class="opt"><a href="/core/" aria-expanded="false" onclick="toggleSubmenu(event, this)">교육센터</a></li>
        <li class="opt"><a href="/core/" aria-expanded="false" onclick="toggleSubmenu(event, this)">인재채용</a>
          <ul>
            <li class="opt2"><a href="/core/">인재상</a></li>
            <li class="opt2"><a href="/core/">복리후생</a></li>
            <li class="opt2"><a href="/core/">급여체계</a></li>
          </ul>
        </li>
        <li class="opt"><a href="/core/" aria-expanded="false" onclick="toggleSubmenu(event, this)">Contact</a>
          <ul class="rightside">
            <li class="opt2"><a href="/core/">사업문의</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
// 모바일 메뉴 토글 함수
function toggleMenu() {
  const nav = document.querySelector("nav");
  nav.classList.toggle("active");
}

// 서브메뉴 토글 (모바일 전용)
function toggleSubmenu(event, element) {
  event.preventDefault();
  event.stopPropagation();

  let parentLi = element.parentElement;
  let submenu = parentLi.querySelector("ul");
  let isOpen = parentLi.classList.contains("open");

  // 🔹 768px 이하(모바일)에서만 실행
  if (window.innerWidth <= 768) {
    document.querySelectorAll(".opt").forEach((opt) => {
      opt.classList.remove("open");
      opt.querySelector("a").setAttribute("aria-expanded", "false");
    });

    if (!isOpen) {
      parentLi.classList.add("open");
      element.setAttribute("aria-expanded", "true");

      // 서브메뉴 열기
      submenu.style.maxHeight = submenu.scrollHeight + "px";
      submenu.style.opacity = "1";
    } else {
      submenu.style.maxHeight = "0";
      submenu.style.opacity = "0";
    }
  }
}

// 🔹 PC에서만 hover 효과 적용 (스크립트가 모바일에 영향을 주지 않도록 개선)
function enableHoverOnPC() {
  if (window.innerWidth > 768) {
    document.querySelectorAll(".opt > ul").forEach((submenu) => {
      submenu.style.maxHeight = "0";
      submenu.style.opacity = "0";
      submenu.style.transition = "max-height 0.5s ease-out, opacity 0.5s ease-out";
    });

    const header = document.querySelector("header");
    header.addEventListener("mouseenter", () => {
      document.querySelectorAll(".opt > ul").forEach((submenu) => {
        submenu.style.maxHeight = submenu.scrollHeight + "px";
        submenu.style.opacity = "1";
      });
    });

    header.addEventListener("mouseleave", () => {
      document.querySelectorAll(".opt > ul").forEach((submenu) => {
        submenu.style.maxHeight = "0";
        submenu.style.opacity = "0";
      });
    });
  }
}

// 🔹 페이지 로드 시 및 화면 크기 변경 시 PC/모바일 환경 감지
function checkScreenSize() {
  if (window.innerWidth > 768) {
    enableHoverOnPC(); // PC 전용 hover 기능 활성화
  } else {
    document.querySelectorAll(".opt > ul").forEach((submenu) => {
      submenu.style.maxHeight = "0"; // 모바일에서는 기본적으로 숨김
      submenu.style.opacity = "0";
    });
  }
}

// 🔹 초기 실행 및 창 크기 변경 시 적용
window.addEventListener("load", checkScreenSize);
window.addEventListener("resize", checkScreenSize);
</script>


{% endblock %}